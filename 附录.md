附录A 期刊模板配置代码

A.1 计算机工程与应用（CEA）配置

```python
CEA_CONFIG = {
    'name': '计算机工程与应用',
    'description': '中文核心期刊，中文用方正书宋，英文用Times New Roman，刻度线朝内',
    
    'font': {
        # 主字体族：方正书宋（中文）+ Times New Roman（英文）
        'family': ['FZShuSong-Z01', 'Times New Roman', 'serif'],
        
        # 衬线字体：方正书宋（中文），Times New Roman（英文）
        'serif': ['FZShuSong-Z01', 'SimSun', 'Times New Roman', 'STSong'],
        
        # 无衬线字体：黑体（标题备用），Arial（兼容备用）
        'sans-serif': ['SimHei', 'Microsoft YaHei', 'Arial', 'Helvetica'],
        
        # 字号配置（6号字约7.5pt）
        'titlesize': 7.5,      # 图题：6号（7.5pt）
        'labelsize': 7.5,      # 坐标轴标签：6号（7.5pt）
        'ticksize': 7.5,       # 刻度标签：6号（7.5pt）
        'legendsize': 7.5,     # 图例：6号（7.5pt）
        
        # 字重
        'titleweight': 'normal',  # 期刊要求正常字重
        'labelweight': 'normal',
    },
    
    'figure_size': {
        # 页面比例尺寸（推荐，更直观）
        'full': (6.69, 8.0),      # 整页: 17cm × 20cm
        'half': (6.69, 4.0),      # 半页: 17cm × 10cm
        'quarter': (3.15, 4.0),   # 1/4页: 8cm × 10cm
        'eighth': (3.15, 2.0),    # 1/8页: 8cm × 5cm
        
        # 传统尺寸命名
        'single': (3.15, 2.36),   # 单栏: 8cm × 6cm
        'double': (6.69, 2.76),   # 双栏: 17cm × 7cm
    },
    
    'color': {
        'cycle': ['#000000', '#333333', '#666666', '#999999', '#0000FF'],
    },
    
    'output': {
        'dpi': 300,
        'formats': ['png', 'svg', 'pdf', 'eps'],
    },
    
    'style': {
        'grid': True,
        'grid_alpha': 0.3,
        'spines_top': True,        # 显示上边框
        'spines_right': True,      # 显示右边框
        'spines_bottom': True,     # 显示下边框
        'spines_left': True,       # 显示左边框
        'tick_direction': 'in',    # 刻度线朝内（期刊要求）
        'tick_length': 3,          # 刻度线长度
        'tick_width': 0.8,         # 刻度线宽度
        'axis_label_format': 'physical_quantity/unit',  # 标目格式
    }
}
```

A.2 IEEE Transactions配置

```python
IEEE_CONFIG = {
    'name': 'IEEE Transactions',
    
    'font': {
        'family': ['Arial', 'Helvetica', 'sans-serif'],
        'sans-serif': ['SimHei', 'Microsoft YaHei', 'Arial', 'Helvetica', 'DejaVu Sans'],
        'titlesize': 9,
        'labelsize': 8,
        'ticksize': 7,
    },
    
    'figure_size': {
        'single': (3.5, 2.625),
        'double': (7.0, 2.625),
    },
    
    'color': {
        'cycle': ['#0066CC', '#CC0000', '#009900', '#FF9900'],
    },
}
```

A.3 Nature/Science配置

```python
NATURE_CONFIG = {
    'name': 'Nature/Science',
    
    'font': {
        'family': ['Arial', 'Helvetica', 'sans-serif'],
        'sans-serif': ['SimHei', 'Microsoft YaHei', 'Arial', 'Helvetica', 'DejaVu Sans'],
        'titlesize': 10,
        'labelsize': 8,
        'ticksize': 7,
    },
    
    'figure_size': {
        'single': (3.54, 2.66),
        'double': (7.09, 2.66),
    },
    
    # 色盲友好配色方案（蓝-橙-青绿-粉-黄-浅蓝）
    # 完全避免红绿对比，确保色觉障碍读者可区分
    'color': {
        'cycle': [
            '#0072B2',  # 蓝 - 主色
            '#D55E00',  # 橙 - 对比色
            '#009E73',  # 青绿 - 辅助色
            '#CC79A7',  # 粉 - 强调色
            '#F0E442',  # 黄 - 高亮色
            '#56B4E9',  # 浅蓝 - 补充色
        ],
        'primary': '#0072B2',
        'secondary': '#D55E00',
    },
}
```

**色盲友好配色说明**：该配色方案基于Wong B. (2011)提出的色盲友好颜色集[12]，通过Lab色彩空间优化，确保在红色盲（protanopia）和绿色盲（deuteranopia）视角下仍保持良好的可区分性。六种颜色在色轮上均匀分布，避免相邻颜色在色盲模拟器中混淆。

A.4 学位论文配置

```python
THESIS_CONFIG = {
    'name': '学位论文',
    'name_en': 'Academic Thesis/Dissertation',
    'description': '博士/硕士学位论文，支持彩色和黑白打印',
    
    'font': {
        'family': ['SimHei', 'Times New Roman', 'serif'],
        'sans-serif': ['SimHei', 'Microsoft YaHei', 'Arial'],
        'serif': ['SimSun', 'Times New Roman', 'STSong'],
        'titlesize': 12,
        'labelsize': 11,
        'ticksize': 10,
        'legendsize': 10,
    },
    
    'figure_size': {
        'full': (6.0, 8.0),
        'half': (6.0, 4.0),
        'quarter': (3.0, 4.0),
        'single': (3.0, 2.25),
        'double': (6.0, 2.25),
    },
    
    # 兼顾彩色显示和黑白打印
    'color': {
        'cycle': [
            '#000000', '#E69F00', '#56B4E9', '#009E73',
            '#F0E442', '#0072B2', '#D55E00', '#CC79A7'
        ],
        'primary': '#000000',
        'secondary': '#E69F00',
    },
    
    'output': {
        'dpi': 300,
        'formats': ['png', 'svg', 'pdf', 'eps'],
        'preferred_format': 'pdf',
    },
    
    'style': {
        'grid': True,
        'grid_alpha': 0.3,
        'spines_top': False,
        'spines_right': False,
    }
}
```

A.5 教材书籍配置

```python
BOOK_CONFIG = {
    'name': '教材书籍',
    'name_en': 'Textbook/Monograph',
    'description': '学术专著、教材，黑白印刷友好',
    
    'font': {
        'family': ['SimSun', 'Times New Roman', 'serif'],
        'sans-serif': ['SimHei', 'Arial'],
        'serif': ['SimSun', 'Times New Roman', 'STSong'],
        'titlesize': 10,
        'labelsize': 9,
        'ticksize': 8,
        'legendsize': 8,
    },
    
    'figure_size': {
        'full': (5.5, 7.0),
        'half': (5.5, 3.5),
        'quarter': (2.75, 3.5),
        'single': (2.75, 2.0),
        'double': (5.5, 2.0),
    },
    
    # 黑白印刷友好配色
    'color': {
        'cycle': [
            '#000000', '#333333', '#666666', '#999999',
            '#0000FF', '#CC0000', '#009900'
        ],
        'primary': '#000000',
        'secondary': '#333333',
    },
    
    'output': {
        'dpi': 300,
        'formats': ['png', 'pdf', 'eps'],
        'preferred_format': 'pdf',
    },
    
    'style': {
        'grid': False,  # 书籍图表通常不使用网格
        'spines_top': False,
        'spines_right': False,
    }
}
```

附录B 核心类实现代码

B.1 上下文管理器核心实现

```python
class PlotConfigContext:
    """配置上下文管理器，实现配置原子化切换"""
    
    def __enter__(self):
        # 保存原始配置
        self._original_rcparams = plt.rcParams.copy()
        # 应用目标配置
        self._apply_config(self.merged_config)
        return self
    
    def __exit__(self, exc_type, exc_val, exc_tb):
        # 恢复原始配置
        if self._original_rcparams is not None:
            plt.rcParams.update(self._original_rcparams)
```

B.2 PlotTool简化API核心实现

```python
class PlotTool:
    """简化API类，提供一键式图表生成"""

    def __init__(self, publication='default', config_file=None,
                 auto_check=True, output_dir='.'):
        self.publication = publication
        self.auto_check = auto_check
        self.config = get_publication_config(publication) if not config_file else \
                      self._load_config_file(config_file)
        self.output_manager = OutputManager(
            default_dpi=self.config.get('output', {}).get('dpi', 300)
        )
        self.fig = None
        self.ax = None
    
    def __enter__(self):
        self._original_rcparams = plt.rcParams.copy()
        self._apply_config()
        return self
    
    def __exit__(self, exc_type, exc_val, exc_tb):
        if self._original_rcparams is not None:
            plt.rcParams.update(self._original_rcparams)
    
    def plot(self, x, y=None, label=None, **kwargs):
        if self.ax is None:
            self.subplots()
        defaults = {'linewidth': 1.5}
        defaults.update(kwargs)
        return self.ax.plot(x, y, label=label, **defaults)
    
    def save(self, filepath, formats=None, dpi=None):
        if formats is None:
            formats = ['jpg', 'svg', 'pdf', 'eps']
        return self.output_manager.save_multiformat(
            self.fig, filepath, formats=formats, dpi=dpi
        )
```

B.3 字体管理器核心实现

```python
class FontManager:
    """字体管理器 - 提供智能字体选择和回退机制"""
    
    _available_fonts: Optional[Set[str]] = None
    
    @classmethod
    def get_available_fonts(cls) -> Set[str]:
        """获取系统中所有可用的字体名称"""
        if cls._available_fonts is None:
            cls._available_fonts = cls._scan_system_fonts()
        return cls._available_fonts
    
    @classmethod
    def _scan_system_fonts(cls) -> Set[str]:
        """扫描系统中的所有字体"""
        fonts = set()
        for font in fm.fontManager.ttflist:
            fonts.add(font.name)
        fonts.update(['sans-serif', 'serif', 'monospace'])
        return fonts
    
    @classmethod
    def is_font_available(cls, font_name: str) -> bool:
        """检查指定字体是否可用"""
        if font_name in ['sans-serif', 'serif', 'monospace']:
            return True
        available = cls.get_available_fonts()
        return font_name in available
    
    @classmethod
    def select_font(cls, font_list: List[str]) -> str:
        """从字体列表中选择第一个可用的字体"""
        for font in font_list:
            if cls.is_font_available(font):
                return font
        return font_list[-1] if font_list else 'sans-serif'
    
    @classmethod
    def get_font_config(cls, font_prefs: Dict) -> Dict:
        """根据字体偏好配置，生成实际可用的字体配置"""
        config = {}
        
        # 处理主字体族
        if 'family' in font_prefs:
            family = font_prefs['family']
            if isinstance(family, list):
                config['family'] = [cls.select_font(family)]
            else:
                config['family'] = [family] if cls.is_font_available(family) else ['sans-serif']
        
        # 处理无衬线字体
        if 'sans-serif' in font_prefs:
            sans_serif = font_prefs['sans-serif']
            if isinstance(sans_serif, list):
                config['sans-serif'] = [f for f in sans_serif if cls.is_font_available(f)]
            else:
                config['sans-serif'] = [sans_serif] if cls.is_font_available(sans_serif) else ['DejaVu Sans']
        
        # 处理衬线字体
        if 'serif' in font_prefs:
            serif = font_prefs['serif']
            if isinstance(serif, list):
                config['serif'] = [f for f in serif if cls.is_font_available(f)]
            else:
                config['serif'] = [serif] if cls.is_font_available(serif) else ['DejaVu Serif']
        
        # 复制其他配置（字号、字重等）
        for key in ['titlesize', 'labelsize', 'ticksize', 'legendsize']:
            if key in font_prefs:
                config[key] = font_prefs[key]
        
        return config
```

**字体管理器工作原理**：

1. **系统字体扫描**：首次使用时扫描系统中所有可用字体并缓存
2. **智能选择**：按优先级顺序检查字体列表，选择第一个可用字体
3. **自动过滤**：自动过滤掉配置中不可用字体，避免matplotlib警告
4. **健壮性保障**：确保在任何系统上都能找到合适的字体显示

附录C 使用示例

C.1 单图绘制示例（中文期刊场景）

```python
from utils.plot_utils import PlotTool
import numpy as np

# 生成数据
x = np.linspace(0, 10, 100)
y1 = np.sin(x)
y2 = np.cos(x)

# 使用简化API生成图表
with PlotTool('cea') as tool:
    tool.plot(x, y1, label='正弦曲线', linewidth=2)
    tool.plot(x, y2, label='余弦曲线', linestyle='--')
    tool.set_labels('时间 (s)', '振幅', '正弦和余弦函数')
    tool.legend()
    tool.grid()
    tool.save('output/cea_example')
```

C.2 多子图绘制示例（鸢尾花分类分析）

```python
from sklearn.datasets import load_iris
from utils.plot_utils import PlotTool
import matplotlib.pyplot as plt

# 加载真实数据集
iris = load_iris()
X, y = iris.data, iris.target
target_names = iris.target_names

with PlotTool('nature') as tool:
    # 创建2×2子图
    fig, axes = tool.subplots(nrows=2, ncols=2, size='double')
    
    # 子图1: 花萼特征散点图
    for i, target in enumerate(target_names):
        mask = y == i
        axes[0, 0].scatter(X[mask, 0], X[mask, 1], label=target, 
                          alpha=0.7, s=50, edgecolors='black', linewidth=0.5)
    axes[0, 0].set_xlabel('花萼长度 (cm)', fontsize=9)
    axes[0, 0].set_ylabel('花萼宽度 (cm)', fontsize=9)
    axes[0, 0].set_title('(a) 花萼特征分布', fontsize=10, fontweight='bold')
    axes[0, 0].legend(fontsize=7, loc='upper right')
    axes[0, 0].grid(True, alpha=0.3)
    
    # 子图2: 花瓣特征散点图
    for i, target in enumerate(target_names):
        mask = y == i
        axes[0, 1].scatter(X[mask, 2], X[mask, 3], label=target,
                          alpha=0.7, s=50, edgecolors='black', linewidth=0.5)
    axes[0, 1].set_xlabel('花瓣长度 (cm)', fontsize=9)
    axes[0, 1].set_ylabel('花瓣宽度 (cm)', fontsize=9)
    axes[0, 1].set_title('(b) 花瓣特征分布', fontsize=10, fontweight='bold')
    axes[0, 1].legend(fontsize=7, loc='upper left')
    axes[0, 1].grid(True, alpha=0.3)
    
    # 子图3: 花瓣长度分布直方图
    for i, target in enumerate(target_names):
        mask = y == i
        axes[1, 0].hist(X[mask, 2], bins=15, alpha=0.6,
                       label=target, edgecolor='black', linewidth=0.5)
    axes[1, 0].set_xlabel('花瓣长度 (cm)', fontsize=9)
    axes[1, 0].set_ylabel('频数', fontsize=9)
    axes[1, 0].set_title('(c) 花瓣长度分布', fontsize=10, fontweight='bold')
    axes[1, 0].legend(fontsize=7)
    axes[1, 0].grid(True, axis='y', alpha=0.3)
    
    # 子图4: 箱线图
    data_for_box = [X[y==i, 2] for i in range(3)]
    bp = axes[1, 1].boxplot(data_for_box, labels=target_names, patch_artist=True)
    axes[1, 1].set_xlabel('类别', fontsize=9)
    axes[1, 1].set_ylabel('花瓣长度 (cm)', fontsize=9)
    axes[1, 1].set_title('(d) 各类别花瓣长度统计', fontsize=10, fontweight='bold')
    axes[1, 1].grid(True, axis='y', alpha=0.3)
    
    plt.tight_layout()
    tool.save('output/iris_analysis')
```

C.3 配置文件驱动示例

YAML配置文件（custom_config.yaml）：

```yaml
font:
  family: ['Arial', 'sans-serif']
  titlesize: 12
  labelsize: 10
  ticksize: 9
figure_size:
  single: [4, 3]
  double: [8, 3]
output:
  dpi: 300
  formats: ['png', 'svg', 'pdf', 'eps']
color:
  cycle: ['#0072B2', '#D55E00', '#009E73', '#CC79A7']
```

Python代码：

```python
from utils.plot_utils import PlotTool
import numpy as np

x = np.linspace(0, 10, 100)

with PlotTool(config_file='custom_config.yaml') as tool:
    tool.plot(x, np.sin(x), label='sin(x)')
    tool.plot(x, np.cos(x), label='cos(x)')
    tool.set_labels('X', 'Y', '自定义配置示例')
    tool.legend()
    tool.save('output/custom_example')
```

C.4 一行代码快速绘图示例

```python
from utils.plot_utils import PlotTool
import numpy as np

x = np.linspace(0, 10, 100)
y = np.sin(x) * np.exp(-x/10)

# 一行代码完成所有操作
PlotTool.quick_plot(
    x, y,
    publication='ieee',
    xlabel='Time (s)',
    ylabel='Amplitude',
    title='Damped Sine Wave',
    label='sin(x)·exp(-x/10)',
    output='output/quick_example'
)
```

C.5 API对比示例

matplotlib原生API示例（约18行）：

```python
import matplotlib.pyplot as plt
import numpy as np
import os

# 手动设置中文字体
plt.rcParams['font.sans-serif'] = ['SimHei', 'Arial']
plt.rcParams['axes.unicode_minus'] = False

# 创建图表
fig, ax = plt.subplots(figsize=(3.15, 2.36), dpi=300)

# 绘制数据
x = np.linspace(0, 10, 100)
ax.plot(x, np.sin(x), label='正弦曲线', linewidth=1.5)
ax.plot(x, np.cos(x), label='余弦曲线', linestyle='--')

# 设置标签和样式
ax.set_xlabel('时间 (s)', fontsize=10)
ax.set_ylabel('振幅', fontsize=10)
ax.set_title('正弦和余弦函数', fontsize=11, fontweight='bold')
ax.legend(fontsize=9)
ax.grid(True, alpha=0.3)

# 手动保存多格式
os.makedirs('output', exist_ok=True)
fig.savefig('output/fig.png', dpi=300, facecolor='white')
fig.savefig('output/fig.pdf', format='pdf')
fig.savefig('output/fig.svg', format='svg')
fig.savefig('output/fig.eps', format='eps')

plt.close(fig)
```

本工具链简化API示例（约8行）：

```python
from utils.plot_utils import PlotTool
import numpy as np

x = np.linspace(0, 10, 100)

with PlotTool('cea') as tool:
    tool.plot(x, np.sin(x), label='正弦曲线')
    tool.plot(x, np.cos(x), label='余弦曲线', linestyle='--')
    tool.set_labels('时间 (s)', '振幅', '正弦和余弦函数')
    tool.legend()
    tool.grid()
    tool.save('output/fig')  # 自动保存4种格式
```